# Network Layer

## Router에서 하는 일

### Forwarding

패킷의 목적지에 알맞은 라우터로 패킷을 보내는 일.

이때 라우터 내부에는 Forwarding Table이 존재하며, 이 테이블을 통해 패킷의 목적지에 알맞은 라우터를 찾아 패킷을 전송한다.

목적지와 주소를 매핑할 때는 `Longest Prefix Matching`을 사용한다.

<details>
  <summary>Longest Prefix Matching</summary>
  <div>
  |Destination Address Range|Link Interface|
  |---|---|
  |11001000 00010111 00010*** ********|0|
  |11001000 00010111 00011000 ********|1|
  |11001000 00010111 00011*** ********|2|
  |otherwise|3|

위와 같은 Forwarding Table이 있다고 하자.

`11001000 00010111 00011000 10101010` 목적지 주소를 가진 패킷이 도착했을 때 어떤 인터페이스로 전송될까?

테이블의 Range 값과 비교하면서 가장 매치가 많이 된 인터페이스로 전송된다.

인터페이스 1,2 모두 일치하지만 인터페이스 1번이 가장 많이 일치하기 때문에 해당 패킷은 1번 인터페이스로 전송된다.

  </div>
</details>

Forwarding Table은 어떻게 생겼을까?

| Network Destination | Netmask       | Gateway  | Interface | Metric |
| ------------------- | ------------- | -------- | --------- | ------ |
| 101.25.67.0         | 255.255.255.0 | 10.0.0.2 | eth3      | 1      |
| 101.25.67.0         | 255.255.255.0 | 10.0.0.2 | eth3      | 1      |
| 101.25.67.0         | 255.255.255.0 | 10.0.0.2 | eth3      | 1      |

| 구성요소            | 역할                                                                                                      |
| ------------------- | --------------------------------------------------------------------------------------------------------- |
| Network Destination | 목적지 네트워크의 IP 주소                                                                                 |
| Netmask             | _서브넷 마스크, 대상 주소를 설명할 때 쓰이는 값_                                                          |
| Gateway             | 이 장치와 연결되어 있는 _홉_,패킷이 전달되는 다음 IP 주소                                                 |
| Interface           | 게이트웨이로 가기 위해 거치는 장치                                                                        |
| Metric              | 우선순위라고 불리며 패킷 전송을 위해 최적의 경로가 선택되도록 참고되는 값, 낮은 것이 우선순위가 높다는 것 |

#Gateway

게이트웨이는 프로토콜 변환기라고도 하며 네트워크와 네트워크를 잇는 장치이다

### Routing
